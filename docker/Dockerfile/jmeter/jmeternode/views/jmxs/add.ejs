<!-- Edit Add Modal HTML -->
<div id="addModal" class="modal fade">
    <div class="modal-dialog">
        <div class="modal-content">
            <form action="/add" method="post" enctype='multipart/form-data' onsubmit="return CheckJmx(this);">
                <div class="modal-body">
                    <div class="form-group">
                        <label>Name</label>
                        <input type="text" id="name" name="name" class="form-control" value="">
                        <input type="hidden" id="rightname" name="rightname" class="form-control" value="">
                    </div>
                    <div class="form-group">
                        <label>File</label>
                        <input id="files" type="file" name="files" style="display:none" multiple>
                        <div class="input-append">
                            <input id="uploadfile" class="form-control" type="text" name="filename" style="width: 70%">
                            <a class="btn btn-info" onclick="$('input[id=files]').click();" style="float:right;margin-top:-34px;width: 30%">Browse</a>
                        </div>
                    </div>
                    <script>
                        $('input[id=name]').change(function () {
                            $("#rightname").val("")
                            $.ajax({
                                url: '/uniqname',
                                dataType: "json",
                                data: 'name=' + $(this).val(),
                                type: 'POST',
                                success: function (data) {
                                    console.log(data);
                                    // console.log('Success!')
                                    $("#rightname").val($("#name").val())
                                },
                                error: function (error, status, message) {
                                    alert("name must be uniq!");
                                    $("#rightname").val("")
                                },
                            });
                        });
                        $('input[id=files]').change(function () {
                            var files = $(this)[0].files;
                            console.log(files[0])
                            console.log(typeof (files))
                            var num = 0;
                            var value = []
                            for (var i = 0; i < files.length; i++) {
                                file = files[i]
                                if (file.name.endsWith(".jmx")) {
                                    num++;
                                } else {
                                    console.log("other files")
                                }
                                value.push(file.name)
                            }
                            if (num != 1) {
                                alert("only need 1 jmx file")
                            } else {
                                $('#uploadfile').val(strLenCut(value.join(','),30));
                            }
                        });
                    </script>
                </div>
                <div class="modal-footer">
                    <input type="button" class="btn btn-default" data-dismiss="modal" value="Cancel">
                    <input type="submit" class="btn btn-success" value="Add">
                </div>
            </form>
        </div>
    </div>
</div>